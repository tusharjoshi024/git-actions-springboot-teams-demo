
name: Build

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v1
      - name: Set up JDK 13
        uses: actions/setup-java@v1
        with:
          java-version: 13
      - name: Build with Gradle
        run: ./gradlew
      - name: Archive build
        uses: actions/upload-artifact@v2
        with:
          name: java-app-${{ github.run_number}}
          path: java-app/build/libs/*.jar
      - name: When the job fails, send the message on teams channel :(
        if: ${{failure()}}
        uses: dhollerbach/github-action-send-message-to-ms-teams@1.0.10
        with:
            webhook: 'https://outlook.office.com/webhook/ee11a014-7e89-4236-b5a8-44ff49884fad@e0793d39-0939-496d-b129-198edd916feb/IncomingWebhook/f1d0852813db4607af7d932da153e39c/3aab8904-3ba2-486e-b9ee-9246128ae1c4'
            message: 'Build Failed'
      - name: When the job succeeds, notify the team :)
        if: ${{success()}}
        uses: dhollerbach/github-action-send-message-to-ms-teams@1.0.10
        with:
            webhook: 'https://outlook.office.com/webhook/ee11a014-7e89-4236-b5a8-44ff49884fad@e0793d39-0939-496d-b129-198edd916feb/IncomingWebhook/f1d0852813db4607af7d932da153e39c/3aab8904-3ba2-486e-b9ee-9246128ae1c4'
            message: 'New build deployed!'
      